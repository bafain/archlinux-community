# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Sven Kauber <celeon@gmail.com>

pkgname=bwm-ng
pkgver=0.6.1
pkgrel=3
pkgdesc="A small and simple console-based live bandwidth monitor"
arch=('x86_64')
url="https://www.gropp.org/"
license=('GPL')
depends=('ncurses')
source=("https://www.gropp.org/bwm-ng/${pkgname}-${pkgver}.tar.gz"
        "https://github.com/vgropp/bwm-ng/commit/f54b3fad2c80bfe63f920c9b5e7c1d80389c57ef.diff")
md5sums=('ef0c7669508e95f56250ad4f8db98b7f'
         'cd5872a5c5328e19cb9cee67d4a5636d')

prepare() {
  cd "$srcdir/${pkgname}-${pkgver}"
  # fix for gcc7
  patch -Np1 -i ../f54b3fad2c80bfe63f920c9b5e7c1d80389c57ef.diff
}

build() {
  cd "$srcdir/${pkgname}-${pkgver}"
  ./configure --prefix=/usr --mandir="$pkgdir/usr/share/man"
  make
}

package() {
  cd "$srcdir/${pkgname}-${pkgver}"
  make prefix="$pkgdir" install

  install -d "$pkgdir/usr"
  mv "$pkgdir/bin" "$pkgdir/usr/"
}
